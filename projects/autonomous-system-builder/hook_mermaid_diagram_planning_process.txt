# Claude Code Hooks: Planning Process Autonomous Flowchart

## Purpose
This flowchart autonomously executes the 8-phase planning methodology to create comprehensive planning artifacts that serve as inputs to the implementation flowchart.

## Decision Node Intelligence Classification

**Legend:**
- ðŸ¤– **PROGRAMMATIC** - Clear binary/numeric checks, fast execution
- ðŸ§  **LLM** - Requires human-like judgment and reasoning
- âš¡ **HYBRID** - Programmatic first, LLM analysis if needed

```mermaid
flowchart TD
    Start([Planning Process Started]) --> ProjectInputCheck{ðŸ¤– Project Requirements Available?}
    
    ProjectInputCheck -->|Yes| LoadProjectRequirements[ðŸ¤– Load Project Requirements]
    ProjectInputCheck -->|No| RequestProjectRequirements["`**REQUEST**: Provide project requirements
    - Problem statement
    - Success criteria  
    - Key constraints`"]
    
    LoadProjectRequirements --> InitializePlanningState[ðŸ¤– Initialize Planning State]
    InitializePlanningState --> PhaseRouter{ðŸ¤– Current Planning Phase?}
    
    %% PHASE ROUTING
    PhaseRouter -->|Phase 1| Phase1Overview[Phase 1: Overview]
    PhaseRouter -->|Phase 2| Phase2Behavior[Phase 2: Behavior + Acceptance Tests]
    PhaseRouter -->|Phase 3| Phase3Architecture[Phase 3: Architecture + Contract Integration Tests]
    PhaseRouter -->|Phase 4| Phase4Dependencies[Phase 4: External Dependency Research]
    PhaseRouter -->|Phase 5| Phase5Pseudocode[Phase 5: Pseudocode + Architecture Review]
    PhaseRouter -->|Phase 6| Phase6Implementation[Phase 6: Implementation Plans + Unit Tests]
    PhaseRouter -->|Phase 7| Phase7Files[Phase 7: Create Files & Cross-References]
    PhaseRouter -->|Phase 8| PlanningComplete[Planning Complete]
    
    %% PHASE 1: OVERVIEW
    Phase1Overview --> AnalyzeRequirements{ðŸ§  LLM: Analyze Project Requirements}
    AnalyzeRequirements --> DraftOverview[ðŸ§  LLM: Draft Overview Document]
    DraftOverview --> Phase1Validation{ðŸ§  LLM: Validate Overview Quality}
    
    Phase1Validation -->|Quality >= 0.8| Phase1Complete[Phase 1 Complete]
    Phase1Validation -->|Quality < 0.8| IdentifyOverviewProblems[ðŸ§  LLM: Identify Overview Issues]
    IdentifyOverviewProblems --> RefineOverview[ðŸ§  LLM: Refine Overview]
    RefineOverview --> Phase1Validation
    
    Phase1Complete --> CheckPhase1Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase1Impact -->|No impact| AdvanceToPhase2[Advance to Phase 2]
    CheckPhase1Impact -->|Major impact| MacroIteration1[Macro-Iteration Required]
    
    %% PHASE 2: BEHAVIOR + ACCEPTANCE TESTS
    Phase2Behavior --> LoadOverview[ðŸ¤– Load Overview Document]
    LoadOverview --> DefineBehavior{ðŸ§  LLM: Define System Behavior}
    DefineBehavior --> CreateAcceptanceTests[ðŸ§  LLM: Create Acceptance Tests]
    CreateAcceptanceTests --> ValidateBehaviorTests{ðŸ§  LLM: Validate Behavior + Tests Alignment}
    
    ValidateBehaviorTests -->|Quality >= 0.8| Phase2Complete[Phase 2 Complete]
    ValidateBehaviorTests -->|Quality < 0.8| IdentifyBehaviorProblems[ðŸ§  LLM: Identify Behavior Issues]
    IdentifyBehaviorProblems --> RefineBehavior[ðŸ§  LLM: Refine Behavior + Tests]
    RefineBehavior --> ValidateBehaviorTests
    
    Phase2Complete --> CheckPhase2Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase2Impact -->|No impact| AdvanceToPhase3[Advance to Phase 3]
    CheckPhase2Impact -->|Major impact| MacroIteration2[Macro-Iteration Required]
    
    %% PHASE 3: ARCHITECTURE + CONTRACT INTEGRATION TESTS
    Phase3Architecture --> LoadBehaviorDocs[ðŸ¤– Load Overview + Behavior Documents]
    LoadBehaviorDocs --> DefineArchitecture{ðŸ§  LLM: Define System Architecture}
    DefineArchitecture --> CreateContractTests[ðŸ§  LLM: Create Contract Integration Tests]
    CreateContractTests --> ValidateArchitectureTests{ðŸ§  LLM: Validate Architecture + Contract Tests}
    
    ValidateArchitectureTests -->|Quality >= 0.8| Phase3Complete[Phase 3 Complete]
    ValidateArchitectureTests -->|Quality < 0.8| IdentifyArchitectureProblems[ðŸ§  LLM: Identify Architecture Issues]
    IdentifyArchitectureProblems --> RefineArchitecture[ðŸ§  LLM: Refine Architecture + Tests]
    RefineArchitecture --> ValidateArchitectureTests
    
    Phase3Complete --> CheckPhase3Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase3Impact -->|No impact| AdvanceToPhase4[Advance to Phase 4]
    CheckPhase3Impact -->|Major impact| MacroIteration3[Macro-Iteration Required]
    
    %% PHASE 4: EXTERNAL DEPENDENCY RESEARCH
    Phase4Dependencies --> LoadArchitectureDocs[ðŸ¤– Load Overview + Behavior + Architecture]
    LoadArchitectureDocs --> IdentifyExternalDeps{ðŸ§  LLM: Identify External Dependencies}
    IdentifyExternalDeps --> ResearchDependencies[ðŸ§  LLM: Research External APIs/Services]
    ResearchDependencies --> CreateExternalTests[ðŸ§  LLM: Create External Integration Tests]
    CreateExternalTests --> ValidateDependencyTests{ðŸ§  LLM: Validate Dependency Research + Tests}
    
    ValidateDependencyTests -->|Quality >= 0.8| Phase4Complete[Phase 4 Complete]
    ValidateDependencyTests -->|Quality < 0.8| IdentifyDependencyProblems[ðŸ§  LLM: Identify Dependency Issues]
    IdentifyDependencyProblems --> RefineDependencies[ðŸ§  LLM: Refine Dependency Research + Tests]
    RefineDependencies --> ValidateDependencyTests
    
    Phase4Complete --> CheckPhase4Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase4Impact -->|No impact| AdvanceToPhase5[Advance to Phase 5]
    CheckPhase4Impact -->|Major impact| MacroIteration4[Macro-Iteration Required]
    
    %% PHASE 5: PSEUDOCODE + ARCHITECTURE REVIEW
    Phase5Pseudocode --> LoadAllPlanningDocs[ðŸ¤– Load All Planning Documents (Phases 1-4)]
    LoadAllPlanningDocs --> CreatePseudocode{ðŸ§  LLM: Create Detailed Pseudocode}
    CreatePseudocode --> ArchitectureReview{ðŸ§  LLM: Review Architecture Consistency}
    ArchitectureReview --> ValidatePseudocode{ðŸ§  LLM: Validate Pseudocode + Architecture Alignment}
    
    ValidatePseudocode -->|Quality >= 0.8| Phase5Complete[Phase 5 Complete]
    ValidatePseudocode -->|Quality < 0.8| IdentifyPseudocodeProblems[ðŸ§  LLM: Identify Pseudocode Issues]
    IdentifyPseudocodeProblems --> RefinePseudocode[ðŸ§  LLM: Refine Pseudocode + Architecture]
    RefinePseudocode --> ValidatePseudocode
    
    Phase5Complete --> CheckPhase5Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase5Impact -->|No impact| AdvanceToPhase6[Advance to Phase 6]
    CheckPhase5Impact -->|Major impact| MacroIteration5[Macro-Iteration Required]
    
    %% PHASE 6: IMPLEMENTATION PLANS + UNIT TESTS
    Phase6Implementation --> LoadAllDocs[ðŸ¤– Load All Documents + Pseudocode (Phases 1-5)]
    LoadAllDocs --> CreateImplementationPlan{ðŸ§  LLM: Create Implementation Plans}
    CreateImplementationPlan --> CreateUnitTests[ðŸ§  LLM: Create Unit Tests]
    CreateUnitTests --> CreateTaskGraph[ðŸ§  LLM: Create Implementation Task Graph]
    CreateTaskGraph --> ValidateImplementationPlans{ðŸ§  LLM: Validate Implementation Plans + Tests + Task Graph}
    
    ValidateImplementationPlans -->|Quality >= 0.8| Phase6Complete[Phase 6 Complete]
    ValidateImplementationPlans -->|Quality < 0.8| IdentifyImplementationProblems[ðŸ§  LLM: Identify Implementation Issues]
    IdentifyImplementationProblems --> RefineImplementationPlans[ðŸ§  LLM: Refine Implementation Plans + Tests + Task Graph]
    RefineImplementationPlans --> ValidateImplementationPlans
    
    Phase6Complete --> CheckPhase6Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase6Impact -->|No impact| AdvanceToPhase7[Advance to Phase 7]
    CheckPhase6Impact -->|Major impact| MacroIteration6[Macro-Iteration Required]
    
    %% PHASE 7: CREATE FILES & CROSS-REFERENCES
    Phase7Files --> LoadAllPlanningArtifacts[ðŸ¤– Load All Planning Artifacts (Phases 1-6)]
    LoadAllPlanningArtifacts --> CreateFileStructure{ðŸ§  LLM: Create File Structure}
    CreateFileStructure --> CreateCrossReferences[ðŸ§  LLM: Create Cross-Reference System]
    CreateCrossReferences --> GenerateProjectStructure[ðŸ§  LLM: Generate Complete Project Structure]
    GenerateProjectStructure --> ValidateFileStructure{ðŸ§  LLM: Validate File Structure + Cross-References}
    
    ValidateFileStructure -->|Quality >= 0.8| Phase7Complete[Phase 7 Complete]
    ValidateFileStructure -->|Quality < 0.8| IdentifyStructureProblems[ðŸ§  LLM: Identify Structure Issues]
    IdentifyStructureProblems --> RefineFileStructure[ðŸ§  LLM: Refine File Structure + Cross-References]
    RefineFileStructure --> ValidateFileStructure
    
    Phase7Complete --> CheckPhase7Impact{ðŸ§  LLM: Impact on Previous Phases?}
    CheckPhase7Impact -->|No impact| PlanningComplete
    CheckPhase7Impact -->|Major impact| MacroIteration7[Macro-Iteration Required]
    
    %% MACRO-ITERATION HANDLING
    MacroIteration1 --> IdentifyImpactedPhases1{ðŸ§  LLM: Which phases need revision?}
    MacroIteration2 --> IdentifyImpactedPhases2{ðŸ§  LLM: Which phases need revision?}
    MacroIteration3 --> IdentifyImpactedPhases3{ðŸ§  LLM: Which phases need revision?}
    MacroIteration4 --> IdentifyImpactedPhases4{ðŸ§  LLM: Which phases need revision?}
    MacroIteration5 --> IdentifyImpactedPhases5{ðŸ§  LLM: Which phases need revision?}
    MacroIteration6 --> IdentifyImpactedPhases6{ðŸ§  LLM: Which phases need revision?}
    MacroIteration7 --> IdentifyImpactedPhases7{ðŸ§  LLM: Which phases need revision?}
    
    IdentifyImpactedPhases1 --> ReviseImpactedPhases1[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases2 --> ReviseImpactedPhases2[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases3 --> ReviseImpactedPhases3[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases4 --> ReviseImpactedPhases4[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases5 --> ReviseImpactedPhases5[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases6 --> ReviseImpactedPhases6[ðŸ§  LLM: Revise Impacted Phases]
    IdentifyImpactedPhases7 --> ReviseImpactedPhases7[ðŸ§  LLM: Revise Impacted Phases]
    
    ReviseImpactedPhases1 --> AdvanceToPhase2
    ReviseImpactedPhases2 --> AdvanceToPhase3
    ReviseImpactedPhases3 --> AdvanceToPhase4
    ReviseImpactedPhases4 --> AdvanceToPhase5
    ReviseImpactedPhases5 --> AdvanceToPhase6
    ReviseImpactedPhases6 --> AdvanceToPhase7
    ReviseImpactedPhases7 --> PlanningComplete
    
    %% PHASE ADVANCEMENT
    AdvanceToPhase2 --> UpdatePlanningState2[ðŸ¤– Update Planning State: Phase 2]
    AdvanceToPhase3 --> UpdatePlanningState3[ðŸ¤– Update Planning State: Phase 3]
    AdvanceToPhase4 --> UpdatePlanningState4[ðŸ¤– Update Planning State: Phase 4]
    AdvanceToPhase5 --> UpdatePlanningState5[ðŸ¤– Update Planning State: Phase 5]
    AdvanceToPhase6 --> UpdatePlanningState6[ðŸ¤– Update Planning State: Phase 6]
    AdvanceToPhase7 --> UpdatePlanningState7[ðŸ¤– Update Planning State: Phase 7]
    
    UpdatePlanningState2 --> PhaseRouter
    UpdatePlanningState3 --> PhaseRouter
    UpdatePlanningState4 --> PhaseRouter
    UpdatePlanningState5 --> PhaseRouter
    UpdatePlanningState6 --> PhaseRouter
    UpdatePlanningState7 --> PhaseRouter
    
    %% PLANNING COMPLETION
    PlanningComplete --> FinalValidation{ðŸ§  LLM: Final Planning Artifact Validation}
    FinalValidation -->|All artifacts valid| GeneratePlanningOutput[ðŸ¤– Generate Planning Output Package]
    FinalValidation -->|Issues found| IdentifyFinalIssues[ðŸ§  LLM: Identify Final Issues]
    
    IdentifyFinalIssues --> ResolveFinalIssues[ðŸ§  LLM: Resolve Final Issues]
    ResolveFinalIssues --> FinalValidation
    
    GeneratePlanningOutput --> CreateTaskGraph[ðŸ¤– Create Implementation Task Graph]
    CreateTaskGraph --> LockPlanningArtifacts[ðŸ¤– Lock Planning Artifacts]
    LockPlanningArtifacts --> HandoffToImplementation["`**HANDOFF**: Planning Complete
    Ready for Implementation Phase`"]
    
    %% SAFETY AND ITERATION LIMITS
    AdvanceToPhase2 --> CheckIterationLimits{ðŸ¤– Check Iteration Limits}
    AdvanceToPhase3 --> CheckIterationLimits
    AdvanceToPhase4 --> CheckIterationLimits
    AdvanceToPhase5 --> CheckIterationLimits
    AdvanceToPhase6 --> CheckIterationLimits
    AdvanceToPhase7 --> CheckIterationLimits
    
    CheckIterationLimits -->|Within limits| PhaseRouter
    CheckIterationLimits -->|Micro-iterations >= 5| ForcePhaseAdvancement[Force Phase Advancement]
    CheckIterationLimits -->|Macro-iterations >= 3| EscalateToHuman["`**ESCALATE**: Iteration limits exceeded
    Human intervention required`"]
    
    ForcePhaseAdvancement --> PhaseRouter
    
    %% TERMINAL STATES
    RequestProjectRequirements --> End([End: Awaiting Input])
    HandoffToImplementation --> End
    EscalateToHuman --> End
    
    %% STYLING
    classDef programmaticNode fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    classDef llmNode fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef hybridNode fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef phaseNode fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef terminalNode fill:#ffebee,stroke:#b71c1c,stroke-width:2px,color:#000
    
    class ProjectInputCheck,LoadProjectRequirements,InitializePlanningState,PhaseRouter,UpdatePlanningState2,UpdatePlanningState3,UpdatePlanningState4,UpdatePlanningState5,UpdatePlanningState6,UpdatePlanningState7,CheckIterationLimits,GeneratePlanningOutput,LockPlanningArtifacts programmaticNode
    class AnalyzeRequirements,DraftOverview,Phase1Validation,DefineBehavior,CreateAcceptanceTests,DefineArchitecture,CreatePseudocode,CreateImplementationPlan,FinalValidation llmNode
    class Phase1Overview,Phase2Behavior,Phase3Architecture,Phase4Dependencies,Phase5Pseudocode,Phase6Implementation,Phase7Files phaseNode
    class RequestProjectRequirements,HandoffToImplementation,EscalateToHuman,End terminalNode
```

## Planning Process Decision Points

### **ðŸ¤– Programmatic Decisions (Fast, Binary)**
- **Project Requirements Check**: File existence and format validation
- **Planning State Management**: Current phase tracking and state updates
- **Iteration Limit Enforcement**: Counter thresholds and safety mechanisms
- **Artifact Generation**: File creation and structure generation

### **ðŸ§  LLM Decisions (Judgment, Context-Aware)**
- **Quality Assessment**: Validate artifacts meet quality thresholds (>0.8 confidence)
- **Problem Identification**: Scan for issues in planning artifacts
- **Impact Analysis**: Determine if changes affect previous phases
- **Content Creation**: Generate all planning documents and tests
- **Final Validation**: Comprehensive planning artifact validation

### **ðŸŽ¯ Key Quality Gates**
1. **Phase Completion**: Each phase requires LLM confidence >0.8
2. **Cross-Phase Impact**: Major changes trigger macro-iterations
3. **Iteration Limits**: Micro (5 per phase), Macro (3 total)
4. **Final Validation**: All artifacts must pass comprehensive validation

### **ðŸ”„ Planning Output Package**
**Generated for Implementation Process:**
- Complete documentation (Overview, Behavior, Architecture, Dependencies)
- All test suites (Acceptance, Contract Integration, External Integration, Unit)
- Detailed pseudocode and implementation plans
- Implementation task graph with dependencies
- File structure and cross-reference system
- Locked planning artifacts (cannot be modified during implementation)

This planning process flowchart autonomously executes the 8-phase methodology with proper quality gates, iteration management, and preparation for handoff to the implementation process.